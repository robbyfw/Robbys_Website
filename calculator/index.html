<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scientific Calculator â€” Muhammad Asim (Robby)</title>

<!-- Favicon -->
<link rel="icon" type="image/png" href="/Studio-Project.png">
<link rel="apple-touch-icon" href="/Studio-Project.png">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
/* ===== Reset & base ===== */
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family:'Poppins',sans-serif;
  background: linear-gradient(270deg,#1c1c1c,#2a2a2a,#1c1c1c);
  background-size:600% 600%;
  animation:waterflow 20s ease infinite;
  -webkit-animation:waterflow 20s ease infinite;
  background-attachment: fixed;
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:20px;
}
@media (max-width:768px){ body{ background-attachment:scroll; padding:12px } }

@keyframes waterflow{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

/* container */
.container{
  width:100%;
  max-width:520px;
  display:flex;
  flex-direction:column;
  gap:16px;
  align-items:center;
}

/* card */
.card{
  width:100%;
  background:rgba(255,255,255,0.04);
  border:1px solid rgba(255,255,255,0.12);
  border-radius:16px;
  padding:20px;
  box-shadow:0 12px 30px rgba(0,0,0,0.6);
  backdrop-filter: blur(12px);
}

/* display */
.display{
  background: rgba(0,0,0,0.36);
  padding:16px 14px;
  border-radius:12px;
  min-height:70px;
  font-size:1.8rem;
  text-align:right;
  overflow-x:auto;
  white-space:nowrap;
  margin-bottom:16px;
}

/* grid layout */
.grid{
  display:grid;
  gap:10px;
  grid-template-columns: repeat(5, 1fr);
}

/* button base */
.btn{
  border: none;
  padding:16px;
  border-radius:12px;
  background: rgba(255,255,255,0.06);
  color: #fff;
  font-size:1rem;
  cursor:pointer;
  box-shadow: 0 6px 12px rgba(0,0,0,0.45);
  transition: transform .12s ease, background .12s ease;
}
.btn:active{ transform: translateY(2px) }
.btn:hover{ background: rgba(0,120,255,0.14) }

/* variants */
.op{ background: linear-gradient(180deg, rgba(0,120,255,0.82), rgba(0,96,200,0.82)); color:#fff }
.func{ background: rgba(200,200,255,0.06); color: #eaf2ff }
.eq { background: linear-gradient(180deg,#00ffab,#00e594); color:#000; grid-column: span 2 }
.clear{ background: linear-gradient(180deg,#ff6b6b,#ff4b4b); color:#fff }
.wide2 { grid-column: span 2 }

/* responsive adjustments */
@media (max-width:520px){
  .grid{ grid-template-columns: repeat(4, 1fr); gap:8px; }
  .eq{ grid-column: span 2 }
  .display{ font-size:1.4rem; min-height:60px }
}

/* footer narrow line */
.footer{
  width:90%;
  max-width:480px;
  text-align:center;
  padding-top:12px;
  border-top:1px solid rgba(255,255,255,0.14);
  color:#ccc;
  font-size:0.95rem;
  margin-top:12px;
  border-radius:6px;
}
</style>
</head>
<body>
  <div class="container">
    <div class="card" role="application" aria-label="Scientific calculator">
      <div class="display" id="display">0</div>

      <div class="grid" id="grid">
        <!-- row 1: clear, back, (, ), Ã· -->
        <button class="btn clear" data-action="clear">C</button>
        <button class="btn func" data-action="back">âŒ«</button>
        <button class="btn func" data-action="(">(</button>
        <button class="btn func" data-action=")">)</button>
        <button class="btn op" data-value="Ã·">Ã·</button>

        <!-- row 2: 7-9, Ã—, âˆš -->
        <button class="btn" data-value="7">7</button>
        <button class="btn" data-value="8">8</button>
        <button class="btn" data-value="9">9</button>
        <button class="btn op" data-value="Ã—">Ã—</button>
        <button class="btn func" data-action="sqrt">âˆš</button>

        <!-- row 3: 4-6, -, âˆ› -->
        <button class="btn" data-value="4">4</button>
        <button class="btn" data-value="5">5</button>
        <button class="btn" data-value="6">6</button>
        <button class="btn op" data-value="-">âˆ’</button>
        <button class="btn func" data-action="cuberoot">âˆ›</button>

        <!-- row 4: 1-3, +, xÂ² -->
        <button class="btn" data-value="1">1</button>
        <button class="btn" data-value="2">2</button>
        <button class="btn" data-value="3">3</button>
        <button class="btn op" data-value="+">+</button>
        <button class="btn func" data-action="pow2">xÂ²</button>

        <!-- row 5: 0, ., Â±, = -->
        <button class="btn wide2" data-value="0">0</button>
        <button class="btn" data-value=".">.</button>
        <button class="btn func" data-action="plusminus">Â±</button>
        <button class="btn eq" data-action="equals">=</button>

        <!-- row 6: scientific functions -->
        <button class="btn func" data-action="sin">sin</button>
        <button class="btn func" data-action="cos">cos</button>
        <button class="btn func" data-action="tan">tan</button>
        <button class="btn func" data-action="ln">ln</button>
        <button class="btn func" data-action="log">log</button>

        <!-- row 7: constants & other functions -->
        <button class="btn func" data-action="exp">eË£</button>
        <button class="btn func" data-action="pi">Ï€</button>
        <button class="btn func" data-action="e">e</button>
        <button class="btn func" data-action="fact">n!</button>
        <button class="btn func" data-action="percent">%</button>
      </div>
    </div>

    <div class="footer">Â© 2025 Muhammad Asim (Robby) â€¢ Built with ðŸ–¤</div>
  </div>

<script>
// Same JS as previous working version
const displayEl = document.getElementById('display');
const grid = document.getElementById('grid');
let expression = '';
let lastAnswer = null;

function refresh(){ displayEl.textContent = expression||'0'; }

function getLastTokenRange(expr) {
  if(!expr) return null;
  let i=expr.length-1;
  while(i>=0&&expr[i]===' ') i--;
  if(i<0) return null;
  if(expr[i]===')'){
    let depth=0;
    for(let j=i;j>=0;j--){
      if(expr[j]===')') depth++;
      else if(expr[j]==='('){ depth--; if(depth===0) return [j,i+1]; }
    }
    return null;
  }
  let start=i;
  while(start>=0&&/[0-9.]/.test(expr[start])) start--;
  return [start+1,i+1];
}

function replaceLastToken(newText){
  const r=getLastTokenRange(expression);
  if(!r) expression+=newText;
  else expression=expression.slice(0,r[0])+newText+expression.slice(r[1]);
  refresh();
}

function appendToken(tok){
  const last=expression.slice(-1);
  if(/^[+\-Ã—Ã·*/^]$/.test(last)&&/^[+\-Ã—Ã·*/^]$/.test(tok)) expression=expression.slice(0,-1)+tok;
  else expression+=tok;
  refresh();
}

grid.addEventListener('click',ev=>{
  const btn=ev.target.closest('button');
  if(!btn) return;
  const value=btn.dataset.value;
  const action=btn.dataset.action;
  if(value!==undefined) appendToken(value);
  else if(action) handleAction(action);
});

function handleAction(act){
  switch(act){
    case 'clear': expression=''; refresh(); break;
    case 'back': expression=expression.slice(0,-1); refresh(); break;
    case '(': case ')': appendToken(act); break;
    case 'sqrt': applySqrt(); break;
    case 'cuberoot': applyCubeRoot(); break;
    case 'pow2': wrapLast('^2'); break;
    case 'plusminus': toggleSign(); break;
    case 'equals': evaluate(); break;
    case 'sin': appendToken('sin('); break;
    case 'cos': appendToken('cos('); break;
    case 'tan': appendToken('tan('); break;
    case 'ln': appendToken('ln('); break;
    case 'log': appendToken('log('); break;
    case 'exp': appendToken('exp('); break;
    case 'pi': appendToken('Ï€'); break;
    case 'e': appendToken('e'); break;
    case 'fact': applyFactorial(); break;
    case 'percent': appendToken('%'); break;
  }
}

function applySqrt(){ const r=getLastTokenRange(expression); if(r){ const tok=expression.slice(r[0],r[1]); expression=expression.slice(0,r[0])+`sqrt(${tok})`; } else expression+='sqrt('; refresh(); }
function applyCubeRoot(){ const r=getLastTokenRange(expression); if(r){ const tok=expression.slice(r[0],r[1]); expression=expression.slice(0,r[0])+`(${tok})^(1/3)`; } else expression+='^(1/3)'; refresh(); }
function wrapLast(suf){ const r=getLastTokenRange(expression); if(r){ const tok=expression.slice(r[0],r[1]); expression=expression.slice(0,r[0])+`(${tok})${suf}`; } else expression+=suf; refresh(); }
function toggleSign(){ const r=getLastTokenRange(expression); if(!r){ expression='-'; refresh(); return; } let tok=expression.slice(r[0],r[1]); if(tok.startsWith('-')) tok=tok.slice(1); else tok='-'+tok; expression=expression.slice(0,r[0])+tok+expression.slice(r[1]); refresh(); }
function applyFactorial(){ const r=getLastTokenRange(expression); if(!r) return; let tok=expression.slice(r[0],r[1]); let n=Number(tok); if(!Number.isFinite(n)||n<0||!Number.isInteger(n)){ alert('Factorial requires non-negative integer'); return; } let res=1; for(let i=2;i<=n;i++) res*=i; expression=expression.slice(0,r[0])+res; refresh(); }

function evaluate(){
  if(!expression){ displayEl.textContent='0'; return; }
  try{
    let code=expression.replace(/Ã—/g,'*').replace(/Ã·/g,'/').replace(/Ï€/g,'Math.PI').replace(/e/g,'Math.E').replace(/\^/g,'**').replace(/([0-9.]+)%/g,'($1/100)');
    const fn=new Function('sin','cos','tan','sqrt','ln','log','exp','root','return ('+code+')');
    const sin=Math.sin, cos=Math.cos, tan=Math.tan, sqrt=Math.sqrt, ln=Math.log, log=Math.log10?Math.log10: x=>Math.log(x)/Math.LN10, exp=Math.exp, root=(n,x)=>Math.pow(x,1/n);
    let res=fn(sin,cos,tan,sqrt,ln,log,exp,root);
    displayEl.textContent=(Math.round(res*1e12)/1e12).toString();
    expression=displayEl.textContent;
    lastAnswer=expression;
  }catch(e){ displayEl.textContent='Error'; }
}
</script>
</body>
</html>
