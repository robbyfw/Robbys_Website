<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  
  <!-- ========== CRITICAL SEO META TAGS ========== -->
  <title>Weather App - Live Weather Forecast & Temperature Updates</title>
  <meta name="description" content="Free weather app with live forecasts, temperature, humidity, wind speed, and 7-day predictions. Get accurate weather updates for any city worldwide.">
  <meta name="keywords" content="weather app, weather forecast, live weather, temperature, humidity, wind speed, weather updates, weather today, 7-day forecast, weather API">
  <meta name="author" content="Robby">
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  <link rel="canonical" href="https://fwrobby.site/weather_app/">
  
  <!-- Open Graph Meta Tags (Facebook, WhatsApp, Discord, etc) -->
  <meta property="og:title" content="Weather App - Live Forecast & Updates">
  <meta property="og:description" content="Get live weather forecasts, temperature, humidity, and wind speed for any location. Free weather app with accurate updates.">
  <meta property="og:image" content="https://fwrobby.site/images/Studio-Project.png">
  <meta property="og:url" content="https://fwrobby.site/weather_app/">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Robby's Website">
  
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Weather App - Live Forecast">
  <meta name="twitter:description" content="Free weather app with live forecasts, temperature, humidity, and wind speed updates">
  <meta name="twitter:image" content="https://fwrobby.site/images/Studio-Project.png">
  
  <!-- Structured Data / Schema.org for Weather App -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Weather App",
    "url": "https://fwrobby.site/weather_app/",
    "description": "Free online weather application providing live forecasts, temperature, humidity, wind speed, and 7-day weather predictions",
    "applicationCategory": "WeatherApplication",
    "operatingSystem": "Any",
    "browserRequirements": "Requires JavaScript and geolocation support",
    "author": {
      "@type": "Person",
      "name": "Robby",
      "url": "https://fwrobby.site/"
    },
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "featureList": [
      "Live weather forecasts",
      "Current temperature",
      "Humidity percentage",
      "Wind speed and direction",
      "7-day weather forecast",
      "City search worldwide",
      "Geolocation detection",
      "Weather icons",
      "Temperature in Celsius/Fahrenheit"
    ],
    "aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": "4.7",
      "ratingCount": "90"
    },
    "potentialAction": {
      "@type": "ViewAction",
      "target": {
        "@type": "EntryPoint",
        "urlTemplate": "https://fwrobby.site/weather_app/",
        "actionPlatform": [
          "http://schema.org/DesktopWebPlatform",
          "http://schema.org/MobileWebPlatform"
        ]
      }
    }
  }
  </script>
  <!-- ========== END SEO META TAGS ========== -->

  <!-- Tab image (Studio Project) -->
  <link rel="icon" type="image/png" href="https://fwrobby.site/images/Studio-Project.png">
  <link rel="apple-touch-icon" href="https://fwrobby.site/images/Studio-Project.png">

  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet" />
</head>
<body>
  <!-- Sidebar Menu -->
  <div id="sidebar" class="sidebar">
    <a href="https://fwrobby.site">Home</a>
    <a href="https://fwrobby.site/about/">About Me</a>
    <a href="https://fwrobby.site/contact/">Contact Me</a>
    <a href="https://fwrobby.site/donate/">Donations</a>
  </div>

  <!-- Hamburger Icon -->
  <div class="hamburger" id="hamburger">
    <span></span>
    <span></span>
    <span></span>
  </div>

  <main class="wrap">
    <section class="card" aria-labelledby="title">
      <h1 id="title" class="app-title">Weather App</h1>

      <div class="controls">
        <input id="cityInput" type="text" placeholder="Enter city name (e.g. Sukho)" aria-label="City name">
        <div class="buttons-row">
          <button id="getBtn" class="btn btn-primary">Get Weather</button>
          <button id="locBtn" class="btn btn-secondary">Check my location</button>
        </div>
      </div>

      <div id="result" class="result" aria-live="polite"></div>

      <!-- Unit toggle INSIDE the card, below results (hidden until a result exists) -->
      <div id="unitContainer" class="unit-container hidden">
        <button id="unitBtn" class="btn btn-ghost">Show °F</button>
      </div>
    </section>

    <!-- credits outside the card, with a thin non-touching line + text below -->
    <div class="credits-wrap">
      <hr class="credits-line">
      <div class="credits-text">Made by Muhammad Asim (Robby)</div>
    </div>
  </main>

  <script>
    // ---------- SIDEBAR ----------
    const hamburger = document.getElementById("hamburger");
    const sidebar = document.getElementById("sidebar");

    hamburger.addEventListener("click", () => {
      sidebar.classList.toggle("open");
      hamburger.classList.toggle("active");
    });

    // ---------- CONFIG ----------
    const API_KEY = "cef868c24f7eadea4f39779c0e588c9b";
    let useCelsius = true;
    let lastWeather = null;

    // ---------- DOM ----------
    const cityInput = document.getElementById('cityInput');
    const getBtn = document.getElementById('getBtn');
    const locBtn = document.getElementById('locBtn');
    const unitBtn = document.getElementById('unitBtn');
    const unitContainer = document.getElementById('unitContainer');
    const resultDiv = document.getElementById('result');

    // ---------- EVENTS ----------
    getBtn.addEventListener('click', () => getWeather());
    locBtn.addEventListener('click', () => getLocationWeather());
    cityInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') getWeather(); });
    unitBtn.addEventListener('click', toggleUnit);

    // ---------- HELPERS ----------
    function showLoading() {
      resultDiv.innerHTML = '<div class="spinner" aria-hidden="true"></div><div class="small">Loading weather…</div>';
      hideUnit();
    }
    function showMessage(msg) {
      resultDiv.innerHTML = '<div class="msg">' + escapeHtml(msg) + '</div>';
      hideUnit();
    }
    function escapeHtml(s) {
      if (s === undefined || s === null) return '';
      return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
    }

    // ---------- WEATHER SVG ----------
    function weatherSVG(main) {
      main = (main || '').toLowerCase();
      if (main.includes('clear')) {
        return `<svg width="84" height="84" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <defs><radialGradient id="sunGrad" cx="50%" cy="40%"><stop offset="0" stop-color="#fff3b0"/><stop offset="1" stop-color="#ffd54d"/></radialGradient></defs>
          <g>
            <circle cx="32" cy="22" r="10" fill="url(#sunGrad)"/>
            <g stroke="#ffd54d" stroke-width="2" stroke-linecap="round">
              <line x1="32" y1="4" x2="32" y2="12"/><line x1="32" y1="36" x2="32" y2="44"/>
              <line x1="12" y1="22" x2="20" y2="22"/><line x1="52" y1="22" x2="44" y2="22"/>
              <line x1="16" y1="8" x2="22" y2="14"/><line x1="48" y1="8" x2="42" y2="14"/>
              <line x1="16" y1="36" x2="22" y2="30"/><line x1="48" y1="36" x2="42" y2="30"/>
            </g>
          </g>
        </svg>`;
      }
      if (main.includes('thunder') || main.includes('storm')) {
        return `<svg width="84" height="84" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <g>
            <ellipse cx="32" cy="26" rx="18" ry="10" fill="#dfefff"/>
            <path d="M28 34 L20 50 L36 42 L30 62" fill="none" stroke="#ffd85a" stroke-width="3" stroke-linecap="round"/>
            <g opacity="0.9"><circle cx="44" cy="24" r="6" fill="#dfefff"/></g>
          </g>
        </svg>`;
      }
      if (main.includes('drizzle') || main.includes('rain')) {
        return `<svg width="84" height="84" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <g>
            <ellipse cx="30" cy="22" rx="16" ry="9" fill="#e6f7ff"/>
            <ellipse cx="44" cy="26" rx="10" ry="7" fill="#eaf7ff"/>
            <g fill="#6fcfff">
              <path d="M22 36c0 3-3 7-3 7s-3-4-3-7c0-1.7 1.3-3 3-3s3 1.3 3 3z"/>
              <path d="M34 36c0 3-3 7-3 7s-3-4-3-7c0-1.7 1.3-3 3-3s3 1.3 3 3z"/>
              <path d="M46 36c0 3-3 7-3 7s-3-4-3-7c0-1.7 1.3-3 3-3s3 1.3 3 3z"/>
            </g>
          </g>
        </svg>`;
      }
      if (main.includes('snow')) {
        return `<svg width="84" height="84" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <g>
            <ellipse cx="30" cy="22" rx="16" ry="9" fill="#eef8ff"/>
            <g fill="#ffffff">
              <circle cx="22" cy="36" r="2.4"/><circle cx="32" cy="40" r="2.4"/><circle cx="42" cy="36" r="2.4"/>
            </g>
            <g opacity="0.9"><ellipse cx="44" cy="26" rx="10" ry="7" fill="#eef8ff"/></g>
          </g>
        </svg>`;
      }
      if (main.includes('mist') || main.includes('fog') || main.includes('haze') || main.includes('smoke') || main.includes('dust') || main.includes('sand') || main.includes('ash')) {
        return `<svg width="84" height="84" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <g>
            <ellipse cx="32" cy="26" rx="18" ry="10" fill="#e9f3fb"/>
            <g fill="rgba(0,0,0,0.06)">
              <rect x="12" y="38" width="40" height="2" rx="1" />
              <rect x="8" y="44" width="48" height="2" rx="1" />
              <rect x="16" y="50" width="32" height="2" rx="1" />
            </g>
          </g>
        </svg>`;
      }
      if (main.includes('squall') || main.includes('tornado')) {
        return `<svg width="84" height="84" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <g fill="none" stroke="#dfefff" stroke-width="2.4" stroke-linecap="round">
            <path d="M10 22c6 0 10-4 18-4 8 0 10 4 18 4"/>
            <path d="M8 34c10 0 14-4 24-4s14 4 28 4"/>
            <path d="M12 46c12 0 18-4 28-4 10 0 14 4 26 4"/>
            <path d="M28 52c2 4 6 8 12 8"/>
          </g>
        </svg>`;
      }
      if (main.includes('cloud')) {
        return `<svg width="84" height="84" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <g>
            <ellipse cx="24" cy="30" rx="14" ry="8" fill="#dfefff"/>
            <ellipse cx="38" cy="28" rx="12" ry="8" fill="#e9f5ff"/>
            <ellipse cx="44" cy="34" rx="10" ry="6" fill="#ecf7ff"/>
          </g>
        </svg>`;
      }
      return `<svg width="84" height="84" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <g>
          <ellipse cx="32" cy="26" rx="18" ry="10" fill="#dfefff"/>
        </g>
      </svg>`;
    }

    // ---------- FETCH & RENDER ----------
    async function getWeather(city = null, lat = null, lon = null) {
      if (!city && (typeof lat !== 'number' || typeof lon !== 'number')) {
        const typed = cityInput.value && cityInput.value.trim();
        if (!typed) { showMessage('Please enter a city name.'); return; }
        city = typed;
      }

      let url;
      if (typeof lat === 'number' && typeof lon === 'number') {
        url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric`;
      } else {
        url = `https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(city)}&appid=${API_KEY}&units=metric`;
      }

      try {
        showLoading();
        const resp = await fetch(url);
        if (!resp.ok) {
          if (resp.status === 404) throw new Error('City not found.');
          throw new Error('Unable to fetch weather.');
        }
        const data = await resp.json();
        lastWeather = data;
        renderWeather(data);
      } catch (err) {
        showMessage(err.message || 'Error fetching weather.');
      }
    }

    async function getLocationWeather() {
      if (!navigator.geolocation) { showMessage('Geolocation not supported.'); return; }
      showLoading();
      navigator.geolocation.getCurrentPosition(async (pos) => {
        const { latitude: lat, longitude: lon } = pos.coords;
        await getWeather(null, lat, lon);
      }, () => showMessage('Location access denied.'), { timeout: 10000 });
    }

    function renderWeather(data) {
      const weatherItem = (data.weather && data.weather[0]) ? data.weather[0] : { main: 'Clouds', description: 'N/A' };
      const main = weatherItem.main || 'Clouds';
      const description = weatherItem.description || 'N/A';
      const nowUtcSec = Math.floor(Date.now() / 1000);
      const tzOffset = data.timezone || 0;
      const localSec = nowUtcSec + tzOffset;
      const localDate = new Date(localSec * 1000);
      const localeStr = localDate.toLocaleString([], { day: 'numeric', month: 'short', hour: '2-digit', minute: '2-digit', hour12: true });
      const tempC = typeof data.main?.temp === 'number' ? data.main.temp : 0;
      const temp = useCelsius ? tempC : (tempC * 9/5) + 32;
      const unit = useCelsius ? '°C' : '°F';
      const svg = weatherSVG(main);

      resultDiv.innerHTML = `
        <div class="top">
          <div class="svg-wrap">${svg}</div>
          <div class="city-block">
            <div class="city-name">${escapeHtml(data.name || 'Unknown')}</div>
            <div class="country">${escapeHtml(data.sys?.country || '')}</div>
            <div class="local-time small">${escapeHtml(localeStr)}</div>
          </div>
        </div>

        <div class="grid">
          <div class="grid-item">
            <div class="label">Temperature</div>
            <div class="value">${temp.toFixed(1)} ${unit}</div>
          </div>
          <div class="grid-item">
            <div class="label">Condition</div>
            <div class="value">${escapeHtml(capitalize(description))}</div>
          </div>
          <div class="grid-item">
            <div class="label">Humidity</div>
            <div class="value">${data.main?.humidity ?? 'N/A'}%</div>
          </div>
          <div class="grid-item">
            <div class="label">Wind</div>
            <div class="value">${data.wind?.speed ?? 'N/A'} m/s</div>
          </div>
        </div>
      `;
      showUnit();
    }

    function toggleUnit() {
      useCelsius = !useCelsius;
      unitBtn.textContent = useCelsius ? 'Show °F' : 'Show °C';
      if (lastWeather) renderWeather(lastWeather);
    }

    function showUnit() { unitContainer.classList.remove('hidden'); }
    function hideUnit() { unitContainer.classList.add('hidden'); }
    function capitalize(s) { if (!s) return s; return s.charAt(0).toUpperCase() + s.slice(1); }
    window.addEventListener('load', () => cityInput.focus());
  </script>
</body>
</html>
