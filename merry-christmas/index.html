<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- SEO Meta Tags -->
    <title>ðŸŽ„ Merry Christmas | Warm Holiday Greetings ðŸŽ„</title>
    <meta name="description" content="ðŸŽ„ Christmas greetings and warm wishes for the holiday season. May this Christmas bring you peace, joy, and happiness. ðŸŽ„">
    <meta name="keywords" content="Christmas, Merry Christmas, holiday greetings, festive season, Christmas wishes">
    <meta name="author" content="Robby">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://fwrobby.site/merry-christmas/picture.png">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            height: 100%;
            overflow: hidden;
            touch-action: none;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #0c0c1d 0%, #121230 50%, #0a0a1a 100%);
            min-height: 100vh;
            min-height: -webkit-fill-available;
            color: #fff;
            position: fixed;
            width: 100%;
            height: 100%;
        }

        /* Animated Background Effect */
        .background-effect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .gradient-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 107, 107, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(107, 107, 255, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(107, 255, 107, 0.08) 0%, transparent 50%);
            animation: gradientShift 20s ease-in-out infinite alternate;
        }

        .floating-shapes {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .shape {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.03);
            filter: blur(40px);
            animation: float 25s infinite linear;
        }

        /* Music Permission Modal */
        .music-permission-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 1;
            transition: opacity 0.5s ease;
        }

        .music-permission-modal.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .permission-card {
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.95) 0%,
                rgba(248, 249, 250, 0.96) 100%);
            border-radius: 24px;
            padding: 40px 35px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 
                0 30px 60px rgba(0, 0, 0, 0.3),
                0 0 0 1px rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.4);
            animation: modalAppear 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .permission-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #ff6b6b, #ff8e53);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .permission-title {
            font-family: 'Dancing Script', cursive;
            font-size: 2.8rem;
            color: #ff6b6b;
            margin-bottom: 15px;
            line-height: 1.2;
        }

        .permission-text {
            font-size: 1.2rem;
            line-height: 1.6;
            color: #333;
            margin-bottom: 30px;
            font-weight: 400;
        }

        .permission-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .permission-btn {
            padding: 16px 35px;
            font-size: 1.1rem;
            font-family: 'Inter', sans-serif;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            min-width: 140px;
        }

        .permission-btn.allow {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            box-shadow: 0 8px 20px rgba(76, 175, 80, 0.3);
        }

        .permission-btn.deny {
            background: linear-gradient(135deg, #f5f5f5, #e8e8e8);
            color: #333;
            border: 1px solid #ddd;
        }

        .permission-btn:hover {
            transform: translateY(-2px);
        }

        .permission-btn:active {
            transform: translateY(0);
        }

        /* Main Container */
        .container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            height: -webkit-fill-available;
            padding: 20px;
            position: relative;
            z-index: 2;
            max-width: 100%;
            overflow: hidden;
            opacity: 1;
            transition: opacity 0.5s ease;
        }

        .container.hidden {
            opacity: 0.5;
            pointer-events: none;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 0 15px;
            width: 100%;
            max-width: 600px;
        }

        .christmas-title {
            font-family: 'Dancing Script', cursive;
            font-size: clamp(3rem, 9vw, 5.5rem);
            background: linear-gradient(45deg, #ff6b6b, #ffd166, #6bcf7f);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            letter-spacing: 1px;
            line-height: 1.2;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            font-size: clamp(1.1rem, 4vw, 1.4rem);
            color: rgba(255, 255, 255, 0.9);
            font-weight: 300;
            letter-spacing: 0.5px;
            line-height: 1.4;
            opacity: 0.9;
        }

        /* Main Button */
        .magic-button {
            background: linear-gradient(135deg, #ff6b6b, #ff8e53);
            color: white;
            border: none;
            padding: clamp(18px, 5vw, 25px) clamp(40px, 9vw, 60px);
            font-size: clamp(1.2rem, 4vw, 1.5rem);
            font-family: 'Inter', sans-serif;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 12px 35px rgba(255, 107, 107, 0.25),
                0 0 0 2px rgba(255, 255, 255, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
            margin-bottom: 30px;
            font-weight: 500;
            letter-spacing: 1.2px;
            min-height: 60px;
            touch-action: manipulation;
        }

        .magic-button:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 18px 45px rgba(255, 107, 107, 0.35),
                0 0 0 2px rgba(255, 255, 255, 0.12),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .magic-button:active {
            transform: translateY(-1px);
            transition: transform 0.1s;
        }

        .button-glow {
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.15), transparent);
            transition: left 0.8s;
        }

        .magic-button:hover .button-glow {
            left: 100%;
        }

        /* Enhanced Greeting Card */
        .greeting-card {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 92%;
            max-width: 520px;
            max-height: 85vh;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.98) 0%,
                rgba(248, 249, 250, 0.96) 100%);
            border-radius: 24px;
            padding: clamp(28px, 6vw, 45px) clamp(22px, 5vw, 40px);
            box-shadow: 
                0 30px 60px rgba(0, 0, 0, 0.25),
                0 0 0 1px rgba(255, 255, 255, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            backdrop-filter: blur(25px);
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            border: 1px solid rgba(255, 255, 255, 0.4);
        }

        .greeting-card.active {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        .card-header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .card-title {
            font-family: 'Dancing Script', cursive;
            font-size: clamp(2.4rem, 7vw, 3.3rem);
            background: linear-gradient(45deg, #ff6b6b, #ff8e53);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            line-height: 1.2;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .card-subtitle {
            color: #666;
            font-size: clamp(1rem, 3.5vw, 1.2rem);
            font-weight: 400;
            letter-spacing: 0.3px;
            opacity: 0.9;
        }

        .message-container {
            position: relative;
            padding: clamp(20px, 5vw, 30px);
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.95) 0%,
                rgba(245, 245, 245, 0.95) 100%);
            border-radius: 18px;
            margin-bottom: 25px;
            box-shadow: 
                0 8px 30px rgba(0, 0, 0, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.6);
        }

        .message-content {
            font-size: clamp(1.05rem, 3.8vw, 1.25rem);
            line-height: 1.75;
            color: #333;
            text-align: center;
            font-weight: 400;
            position: relative;
            z-index: 1;
        }

        .message-decoration {
            position: absolute;
            top: 15px;
            left: 15px;
            width: 30px;
            height: 30px;
            border-top: 2px solid #ff6b6b;
            border-left: 2px solid #ff6b6b;
            opacity: 0.3;
        }

        .message-decoration-bottom {
            position: absolute;
            bottom: 15px;
            right: 15px;
            width: 30px;
            height: 30px;
            border-bottom: 2px solid #6bcf7f;
            border-right: 2px solid #6bcf7f;
            opacity: 0.3;
        }

        .signature {
            text-align: center;
            font-size: clamp(1.2rem, 4vw, 1.4rem);
            color: #ff6b6b;
            font-family: 'Dancing Script', cursive;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 107, 107, 0.2);
            position: relative;
        }

        .signature::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 1px;
            background: linear-gradient(90deg, transparent, #ff6b6b, transparent);
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #ff6b6b, #ff5252);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            font-weight: 300;
            touch-action: manipulation;
            z-index: 1001;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
        }

        .close-btn:hover {
            transform: rotate(90deg) scale(1.1);
        }

        /* Snowflakes */
        .snowflake {
            position: absolute;
            background: white;
            border-radius: 50%;
            pointer-events: none;
            opacity: 0.8;
            filter: blur(1px);
            z-index: 1;
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.5);
        }

        /* Animations */
        @keyframes gradientShift {
            0% {
                background-position: 0% 0%;
            }
            100% {
                background-position: 100% 100%;
            }
        }

        @keyframes float {
            0% {
                transform: translate(0, 0) rotate(0deg);
            }
            25% {
                transform: translate(100px, 100px) rotate(90deg);
            }
            50% {
                transform: translate(0, 200px) rotate(180deg);
            }
            75% {
                transform: translate(-100px, 100px) rotate(270deg);
            }
            100% {
                transform: translate(0, 0) rotate(360deg);
            }
        }

        @keyframes fall {
            0% {
                transform: translate(0, 0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translate(var(--end-x), 100vh) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Mobile-specific optimizations */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .permission-card {
                padding: 35px 25px;
                width: 95%;
            }
            
            .permission-title {
                font-size: 2.2rem;
            }
            
            .permission-text {
                font-size: 1.1rem;
            }
            
            .permission-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .permission-btn {
                width: 100%;
                max-width: 250px;
            }
            
            .header {
                margin-bottom: 35px;
            }
            
            .magic-button {
                width: 92%;
                max-width: 340px;
            }
            
            .greeting-card {
                width: 94%;
                padding: 30px 24px;
            }
            
            .message-container {
                padding: 24px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 12px;
            }
            
            .permission-card {
                padding: 30px 20px;
            }
            
            .permission-title {
                font-size: 2rem;
            }
            
            .permission-text {
                font-size: 1rem;
            }
            
            .header {
                margin-bottom: 30px;
            }
            
            .christmas-title {
                font-size: 2.8rem;
            }
            
            .magic-button {
                width: 90%;
                padding: 20px 35px;
                font-size: 1.15rem;
            }
            
            .greeting-card {
                width: 96%;
                padding: 26px 22px;
                max-height: 80vh;
            }
            
            .message-container {
                padding: 22px;
            }
        }

        @media (max-height: 600px) {
            .permission-card {
                padding: 25px 20px;
            }
            
            .permission-icon {
                font-size: 3rem;
                margin-bottom: 15px;
            }
            
            .permission-title {
                font-size: 1.8rem;
                margin-bottom: 10px;
            }
            
            .permission-text {
                font-size: 1rem;
                margin-bottom: 20px;
            }
            
            .header {
                margin-bottom: 25px;
            }
            
            .christmas-title {
                font-size: 2.5rem;
            }
            
            .magic-button {
                margin-bottom: 25px;
                padding: 18px 32px;
                font-size: 1.1rem;
            }
            
            .greeting-card {
                max-height: 78vh;
                padding: 24px 20px;
            }
        }

        /* Prevent text selection */
        .no-select {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body class="no-select">
    <!-- Music Permission Modal -->
    <div class="music-permission-modal" id="musicPermissionModal">
        <div class="permission-card">
            <div class="permission-icon">ðŸŽµ</div>
            <h2 class="permission-title">Music Permission</h2>
            <p class="permission-text">
                Would you like to play background Christmas music to enhance your holiday experience? 
                The music will add festive cheer to your visit!
            </p>
            <div class="permission-buttons">
                <button class="permission-btn allow" id="allowMusic">Allow Music</button>
                <button class="permission-btn deny" id="denyMusic">No Thanks</button>
            </div>
        </div>
    </div>

    <!-- Animated Background Effect -->
    <div class="background-effect">
        <div class="gradient-overlay"></div>
        <div class="floating-shapes" id="floatingShapes"></div>
    </div>

    <!-- Main Container -->
    <div class="container" id="mainContainer">
        <header class="header">
            <h1 class="christmas-title">Merry Christmas</h1>
            <p class="subtitle">Tap below for a special holiday message</p>
        </header>

        <button class="magic-button" id="magicButton">
            <span class="button-glow"></span>
            Open Christmas Greeting
        </button>
    </div>

    <!-- Greeting Card -->
    <div class="greeting-card" id="greetingCard">
        <button class="close-btn" id="closeBtn">Ã—</button>
        
        <div class="card-header">
            <h2 class="card-title">Merry Christmas</h2>
            <p class="card-subtitle">A Message for You</p>
        </div>
        
        <div class="message-container">
            <div class="message-decoration"></div>
            <div class="message-content">
                <p>May this season bring you peace, warmth, and genuine happiness. May your heart feel light, your home feel joyful, and the coming year open doors to better days and new opportunities. Wishing you love, laughter, and good moments that last beyond the holidays.</p>
            </div>
            <div class="message-decoration-bottom"></div>
        </div>
        
        <div class="signature">
            <p>â€” Robby</p>
        </div>
    </div>

    <!-- Audio -->
    <audio id="christmasMusic" loop playsinline>
        <source src="https://fwrobby.site/merry-christmas/christmas_music.mp3" type="audio/mpeg">
    </audio>

    <script>
        // DOM Elements
        const musicPermissionModal = document.getElementById('musicPermissionModal');
        const mainContainer = document.getElementById('mainContainer');
        const allowMusicBtn = document.getElementById('allowMusic');
        const denyMusicBtn = document.getElementById('denyMusic');
        const magicButton = document.getElementById('magicButton');
        const greetingCard = document.getElementById('greetingCard');
        const closeBtn = document.getElementById('closeBtn');
        const christmasMusic = document.getElementById('christmasMusic');
        const floatingShapes = document.getElementById('floatingShapes');

        // State variables
        let musicAllowed = false;
        let musicStarted = false;

        // Create floating background shapes
        function createFloatingShapes() {
            const shapeCount = 8;
            const sizes = [200, 250, 300, 350];
            const opacities = [0.02, 0.03, 0.04];
            
            for (let i = 0; i < shapeCount; i++) {
                const shape = document.createElement('div');
                shape.className = 'shape';
                
                // Random size
                const size = sizes[Math.floor(Math.random() * sizes.length)];
                shape.style.width = `${size}px`;
                shape.style.height = `${size}px`;
                
                // Random position
                shape.style.left = `${Math.random() * 100}%`;
                shape.style.top = `${Math.random() * 100}%`;
                
                // Random opacity
                shape.style.opacity = opacities[Math.floor(Math.random() * opacities.length)];
                
                // Random animation duration and direction
                const duration = Math.random() * 30 + 30;
                const delay = Math.random() * 10;
                shape.style.animationDuration = `${duration}s`;
                shape.style.animationDelay = `${delay}s`;
                
                // Random color
                const colors = [
                    'rgba(255, 107, 107, 0.1)',
                    'rgba(107, 107, 255, 0.1)',
                    'rgba(107, 255, 107, 0.1)'
                ];
                shape.style.background = colors[Math.floor(Math.random() * colors.length)];
                
                floatingShapes.appendChild(shape);
            }
        }

        // Create snowflakes - ALWAYS RUNNING
        function createSnowflakes() {
            const snowflakeCount = 100;
            
            for (let i = 0; i < snowflakeCount; i++) {
                const snowflake = document.createElement('div');
                snowflake.className = 'snowflake';
                
                // Random size
                const size = Math.random() * 8 + 3;
                snowflake.style.width = `${size}px`;
                snowflake.style.height = `${size}px`;
                
                // Random position
                snowflake.style.left = `${Math.random() * 100}vw`;
                snowflake.style.top = '-20px';
                
                // Random opacity
                snowflake.style.opacity = Math.random() * 0.7 + 0.2;
                
                // Random animation
                const duration = Math.random() * 20 + 15;
                const delay = Math.random() * 10;
                const endX = (Math.random() - 0.5) * 150;
                snowflake.style.setProperty('--end-x', `${endX}px`);
                
                snowflake.style.animation = `fall ${duration}s linear ${delay}s infinite`;
                
                document.body.appendChild(snowflake);
            }
        }

        // Start music playback
        function startMusic() {
            if (!musicAllowed || musicStarted) return;
            
            christmasMusic.volume = 0.25;
            
            const playPromise = christmasMusic.play();
            
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    musicStarted = true;
                    console.log("Music started successfully");
                }).catch(error => {
                    console.log("Music playback failed:", error);
                    // If autoplay fails, show a subtle message
                    showMusicHint();
                });
            }
        }

        // Show hint that music can be started manually
        function showMusicHint() {
            // Create a subtle hint
            const hint = document.createElement('div');
            hint.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(255, 255, 255, 0.1);
                color: white;
                padding: 10px 20px;
                border-radius: 20px;
                font-size: 0.9rem;
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.2);
                z-index: 1000;
                animation: fadeIn 0.5s;
            `;
            hint.textContent = 'Tap anywhere to start music';
            document.body.appendChild(hint);
            
            // Remove hint after 5 seconds
            setTimeout(() => {
                hint.style.opacity = '0';
                hint.style.transition = 'opacity 0.5s';
                setTimeout(() => hint.remove(), 500);
            }, 5000);
        }

        // Hide permission modal and enable main content
        function hidePermissionModal() {
            musicPermissionModal.classList.add('hidden');
            mainContainer.classList.remove('hidden');
            // Create background shapes
            createFloatingShapes();
            // Start snow immediately
            createSnowflakes();
        }

        // Allow music
        function allowMusic() {
            musicAllowed = true;
            hidePermissionModal();
            startMusic();
        }

        // Deny music
        function denyMusic() {
            musicAllowed = false;
            hidePermissionModal();
        }

        // Start Christmas Magic (show greeting card)
        function showGreeting() {
            greetingCard.classList.add('active');
            magicButton.style.display = 'none';
        }

        // Close greeting card
        function closeGreeting() {
            greetingCard.classList.remove('active');
            magicButton.style.display = 'block';
        }

        // Event Listeners
        allowMusicBtn.addEventListener('click', allowMusic);
        denyMusicBtn.addEventListener('click', denyMusic);

        magicButton.addEventListener('click', showGreeting);
        magicButton.addEventListener('touchstart', (e) => {
            e.preventDefault();
            showGreeting();
        });

        closeBtn.addEventListener('click', closeGreeting);
        closeBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            closeGreeting();
        });

        // Close card when clicking outside
        greetingCard.addEventListener('touchstart', (e) => {
            if (e.target === greetingCard) {
                closeGreeting();
            }
        });

        greetingCard.addEventListener('click', (e) => {
            if (e.target === greetingCard) {
                closeGreeting();
            }
        });

        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (greetingCard.classList.contains('active')) {
                    closeGreeting();
                }
                if (!musicPermissionModal.classList.contains('hidden')) {
                    denyMusic();
                }
            }
            if ((e.key === ' ' || e.key === 'Enter') && !greetingCard.classList.contains('active') && musicPermissionModal.classList.contains('hidden')) {
                showGreeting();
            }
        });

        // Start music on any user interaction if allowed but not started
        document.addEventListener('click', () => {
            if (musicAllowed && !musicStarted) {
                startMusic();
            }
        });

        document.addEventListener('touchstart', () => {
            if (musicAllowed && !musicStarted) {
                startMusic();
            }
        });

        // Prevent scrolling
        document.addEventListener('wheel', preventScroll, { passive: false });
        document.addEventListener('touchmove', preventScroll, { passive: false });

        function preventScroll(e) {
            if (!greetingCard.classList.contains('active')) {
                e.preventDefault();
                return false;
            }
        }

        // Ensure proper viewport on mobile
        function setViewportHeight() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            setViewportHeight();
            window.addEventListener('resize', setViewportHeight);
            window.addEventListener('orientationchange', setViewportHeight);
            
            // Show permission modal after a brief delay
            setTimeout(() => {
                musicPermissionModal.classList.remove('hidden');
                mainContainer.classList.add('hidden');
            }, 500);
        });

        // Additional mobile optimization for iOS
        document.addEventListener('touchstart', function() {}, { passive: true });
    </script>
</body>
</html>